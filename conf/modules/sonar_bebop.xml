<!DOCTYPE module SYSTEM "module.dtd">

<module name="sonar">
  <doc>
    <description>
     Bebop Sonar driver.
     Reads an anlog sonar sensor and outputs sonar distance in [m]
    </description>
      <define name="USE_SONAR" value="" description="activate use of sonar in INS extended filter (only rotorcraft)"/>
  </doc>

  <settings>
    <dl_settings NAME="Sonar Bebop">
      <dl_settings name="sonar">
        <dl_setting
                var="sonar_bebop.obstacle_slope_threshold"
                shortname="obstacle_slope_threshold"
                min="0"
                step="1"
                max="20" />
        <dl_setting
                var="sonar_bebop.slope_threshold"
                shortname="slope_threshold"
                min="0"
                step="1"
                max="20" />
        <dl_setting
                var="sonar_bebop.obstacle_acceptance_threshold"
                shortname="obstacle_acceptance_threshold"
                min="0"
                step="1"
                max="20" />
      </dl_settings>
    </dl_settings>
  </settings>

  <header>
    <file name="sonar_bebop.h"/>
  </header>

  <init fun="sonar_bebop_init()"/>

  <makefile target="ap|sim">
    <file name="sonar_bebop.c"/>
  </makefile>
  <makefile target="ap">
    <define name="USE_SPI0" value="1"/>
    <define name="USE_ADC0" value="1"/>
    <define name="USE_SONAR" value="1"/>

    <raw>
      include $(CFG_SHARED)/spi_master.makefile
    </raw>
  </makefile>

</module>
